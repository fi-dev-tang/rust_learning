# 特征 Trait
如果我们想定义一个文件系统，那么把该系统跟底层存储解耦是很重要的。文件操作主要包含四个: open, write, read, close,
这些操作可以发生在硬盘，可以发生在内存，还可以发生在网络IO。
总之如果你要为每一种情况都单独实现一套代码，那这种实现将过于繁杂，而且也没那个必要。

要解决上述问题，需要把这些行为抽象出来，就要使用 Rust 中的特征 trait 概念。
特征跟接口很类似。

在之前的源码中，我们也多次见过特征的使用，例如 #[derive(Debug)], 它在我们定义的类型(struct) 上自动派生 Debug 特征，
接着可以使用
```rust
println!("{:?}", x)
```
打印这个类型；再例如:
```rust
fn add<T: std::ops::Add<Output = T>>(a: T, b: T) -> T {
    a + b
}
```
通过 std::ops::Add 特征来限制 T, 只有 T 实现了 std::ops::Add 才能进行合法的加法操作，毕竟不是所有类型都能进行相加。

这些都说明一个道理，特征定义了**一组可以被共享的行为，只要实现了特征，你就能使用这组行为**。

## 定义特征
如果不同的类型具有相同的行为，那么我们就可以定义一个特征，然后为这些类型实现该特征。**定义特征**是把一些方法组合在一起，目的是定义一个实现某些目标所必需的行为的集合。

例如，我们现在有文章 Post 和微博 Weibo 两种内容载体，而我们想对相应的内容进行总结，也就是无论是文章内容，还是微博内容，都可以在某个时间点进行总结，
那么总结这个行为就是共享的，因此可以用特征来定义:
```rust
pub trait Summary{
    fn summerize(&self) -> String;
}
```
这里使用 trait 关键字来声明一个特征，Summary 是特征名。在大括号中定义了该特征的所有方法，在这个例子中是:
```rust
fn summerize(&self) -> String
```
特征只定义行为看起来是什么样的，而不定义行为具体是怎么样的。因此，我们只定义特征方法的签名，而不进行实现，此时方法签名结尾是 ; , 而不是一个 {}。

接下来，每一个实现这个特征的类型都需要具体实现该特征的相应方法，编译器也会确保任何实现 Summary 特征的类型都拥有与这个签名的定义完全一致的 summarize 方法。

## 为类型实现特征
因为特征只定义行为看起来是什么样的，因此我们需要为类型实现具体的特征，定义行为具体是怎么样的。
首先来为 Post 和 Weibo 实现 Summary 特征:
```rust
pub trait Summary{
    fn summarize(&self) -> String;
}

pub struct Post{
    pub title: String;      // 标题
    pub author: String;     // 作者
    pub content: String;    // 内容
}

impl Summary for Post{
    fn summerize(&self) -> String{
        format!("文章{}, 作者是{}", self.title, self.author)
    }
}

pub struct Weibo{
    pub username: String,
    pub content: String
}

impl Summary for Weibo{
    fn summerize(&self) -> String{
        format!("{}发表了微博{}", self.username, self.content)
    }
}
```
实现特征的语法与结构体、枚举实现方法很像: impl Summary for Post, 读作 "为 Post 类型实现 Summary 特征", 然后在 impl 的花括弧中实现该特征的具体方法。

接下来接可以在这个类型上调用特征的方法:
```rust
fn main(){
    let post = Post{title: "Rust语言简介".to_string(), author: "Sunface".to_string(), content: "Rust 棒极了!".to_string()};
    let weibo = Weibo{username: "sunface".to_string(), content: "好像微博没Tweet好用".to_string()};

    println!("{}", post.summerize());
    println!("{}", weibo.summerize());
}
```
